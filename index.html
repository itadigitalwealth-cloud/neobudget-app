<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>NeoBudget - Bilancio Personale</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- PWA / iOS -->
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="./assets/images/icon-180.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <script type="module" src="https://cdn.jsdelivr.net/npm/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://cdn.jsdelivr.net/npm/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>



  <!-- CSS principale -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="animations.css">

</head>
<body>

  <!-- ============================
       VIEW 1 — HOME
  ============================= -->
  <div id="view-home" class="app-view active">

    <header class="app-header">
      <div class="brand">
        <div class="brand-logo">PB</div>
        <div class="brand-text">
          <h1>Personal Budget</h1>
          <span></span>
        </div>
      </div>
      <div class="header-controls">
        <label class="date-filter-label">
          <span>Data di riferimento</span>
          <input type="date" id="dateFilter">
        </label>
        <button id="btnToday" class="btn primary">Oggi</button>
      </div>
    </header>

    <section class="kpi-grid">
      <div class="kpi-card">
        <span class="kpi-label">Saldo previsto</span>
        <span class="kpi-value" id="stat-saldo">0,00 €</span>
      </div>
      <div class="kpi-card">
        <span class="kpi-label">Liquidità disponibile</span>
        <span class="kpi-value" id="stat-liquidita">0,00 €</span>
      </div>
      <div class="kpi-card">
        <span class="kpi-label">Importo investito</span>
        <span class="kpi-value" id="stat-investito">0,00 €</span>
      </div>
      <div class="kpi-card">
        <span class="kpi-label">Entrate previste</span>
        <span class="kpi-value" id="stat-entrate-previste">0,00 €</span>
      </div>
      <div class="kpi-card">
        <span class="kpi-label">Spese previste</span>
        <span class="kpi-value" id="stat-spese-previste">0,00 €</span>
      </div>
      <div class="kpi-card">
        <span class="kpi-label">Totale complessivo</span>
        <span class="kpi-value" id="stat-totale">0,00 €</span>
      </div>
    </section>

    <section class="chart-panel">
      <h2 class="chart-title">Andamento del mese</h2>
      <div id="chart-month" class="chart-container"></div>
    </section>

    <section class="summary-grid">
      <h2 class="summary-title">Resoconto per categoria</h2>
      <div id="summary-list" class="summary-list"></div>
    </section>

  </div>


  <!-- ============================
       VIEW 2 — MOVIMENTI
  ============================= -->
  <div id="view-movimenti" class="app-view hidden">
    <main class="app-main">

      <aside class="sidebar">
        <section class="panel movement-card">
  <h2>Nuovo movimento</h2>

  <div class="type-selector">
    <button class="type-btn active" data-type="income">Entrata</button>
    <button class="type-btn" data-type="expense">Uscita</button>
  </div>

  <div class="form-collapse" id="movementForm">
    <form id="mov-form" autocomplete="off">

      <div class="field-group">
        <label>Conto</label>
        <select id="mov-account">
          <option value="liquid">Liquidità</option>
          <option value="invested">Investito</option>
        </select>
      </div>

      <div class="field-group">
        <label>Categoria</label>
        <input type="text" id="mov-category" placeholder="Es. Stipendio, Affitto...">
      </div>

      <div class="field-row">
        <div class="field-group half">
          <label>Importo</label>
          <input type="number" id="mov-amount" placeholder="0.00">
        </div>

        <div class="field-group half">
          <label>Data</label>
          <input type="date" id="mov-date">
        </div>
      </div>

      <div class="field-group">
        <label>Note</label>
        <input type="text" id="mov-note" placeholder="Opzionale">
      </div>

      <button type="submit" id="mov-submit" class="btn primary full-width">Aggiungi movimento</button>
      <button type="button" id="mov-cancel" class="btn ghost full-width hidden">Annulla modifica</button>
    </form>
  </div>
</section>

      </aside>

      <section class="content">

        <nav class="tabs">
          <button class="tab active" data-tab="movimenti">Movimenti</button>
          <button class="tab" data-tab="entrate">Entrate ricorrenti</button>
          <button class="tab" data-tab="spese">Spese ricorrenti</button>
        </nav>

        <section class="tab-content active" id="tab-movimenti">
          <div class="table-wrapper">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Data</th>
                  <th>Tipo</th>
                  <th>Conto</th>
                  <th>Categoria</th>
                  <th>Note</th>
                  <th class="align-right">Importo</th>
                  <th class="align-center">Azioni</th>
                </tr>
              </thead>
              <tbody id="mov-list"></tbody>
            </table>
          </div>
        </section>

      </section>

    </main>
  </div>


  <!-- ============================
     VIEW 3 — RICORRENTI (NUOVA)
============================== -->
<div id="view-ricorrenti" class="app-view hidden">

  <!-- NAV TABS -->
  <nav class="tabs" id="rec-tabs">
    <button class="tab active" data-rec-type="income">Entrate</button>
    <button class="tab" data-rec-type="expense">Spese</button>
  </nav>

  <!-- PANEL UNICO -->
  <section class="panel inline-panel" id="rec-panel">
    <h3 id="rec-form-title">Nuova entrata ricorrente</h3>

    <form id="rec-form" autocomplete="off">

      <div class="field-group">
        <label>Nome</label>
        <input type="text" id="rec-name" placeholder="Es. Stipendio mensile">
      </div>

      <div class="field-row">
        <div class="field-group half">
          <label>Importo</label>
          <input type="number" id="rec-amount" min="0" step="0.01">
        </div>
        <div class="field-group half">
          <label>Conto</label>
          <select id="rec-account">
            <option value="liquid">Liquidità</option>
            <option value="invested">Investito</option>
          </select>
        </div>
      </div>

      <div class="field-group">
        <label>Categoria</label>
        <input type="text" id="rec-category" placeholder="Es. Stipendio">
      </div>

      <div class="field-row">
        <div class="field-group half">
          <label>Dal</label>
          <input type="date" id="rec-start">
        </div>
        <div class="field-group half">
          <label>Fino al (opzionale)</label>
          <input type="date" id="rec-end">
        </div>
      </div>

      <div class="field-group">
        <label>Tipo di ricorrenza</label>
        <select id="rec-mode">
          <option value="monthly">Mensile</option>
          <option value="daily">Ogni giorno</option>
          <option value="everyXDays">Ogni X giorni</option>
          <option value="weekly">Ogni X settimane</option>
          <option value="weeklySpecific">Giorni specifici</option>
          <option value="everyXMonths">Ogni X mesi</option>
          <option value="yearly">Annuale</option>
        </select>
      </div>

      <div class="field-row rec-interval-row hidden" id="rec-interval-row">
        <div class="field-group half">
          <label>Intervallo</label>
          <input type="number" id="rec-interval" min="1" value="1">
        </div>
      </div>

      <div class="field-group hidden" id="rec-weekdays-row">
        <label>Giorni della settimana</label>
        <div class="weekday-group" id="rec-weekdays">
          <label class="weekday-chip"><input type="checkbox" value="1"><span>L</span></label>
          <label class="weekday-chip"><input type="checkbox" value="2"><span>M</span></label>
          <label class="weekday-chip"><input type="checkbox" value="3"><span>M</span></label>
          <label class="weekday-chip"><input type="checkbox" value="4"><span>G</span></label>
          <label class="weekday-chip"><input type="checkbox" value="5"><span>V</span></label>
          <label class="weekday-chip"><input type="checkbox" value="6"><span>S</span></label>
          <label class="weekday-chip"><input type="checkbox" value="7"><span>D</span></label>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" id="rec-submit" class="btn primary full-width">Aggiungi</button>
        <button type="button" id="rec-cancel" class="btn ghost full-width hidden">Annulla modifica</button>
      </div>

    </form>
  </section>

  <!-- LISTA -->
  <div class="table-wrapper">
    <table class="data-table">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Categoria</th>
          <th>Ricorrenza</th>
          <th>Dal</th>
          <th>Al</th>
          <th>Conto</th>
          <th class="align-right">Importo</th>
          <th class="align-center">Azioni</th>
        </tr>
      </thead>
      <tbody id="rec-list"></tbody>
    </table>
  </div>

</div>



  <!-- ============================
       VIEW 4 — SETTINGS
  ============================= -->
  <div id="view-settings" class="app-view hidden">

    <section class="panel">
      <h2>Dati & backup</h2>

      <div class="field-group">
        <button id="btnExport" class="btn full-width">Esporta JSON</button>
      </div>
      <div class="field-group">
        <button id="btnImport" class="btn full-width">Importa JSON</button>
        <input type="file" id="fileImport" accept="application/json" class="hidden">
      </div>
      <div class="field-group">
        <button id="btnReset" class="btn danger full-width">Reset completo</button>
      </div>

    </section>
  </div>



  <!-- ============================
       BOTTOM NAVIGATION
  ============================= -->
<nav class="bottom-nav">
  <button class="nav-item active" data-tab-target="home">
    <ion-icon class="nav-icon" name="home-outline"></ion-icon>
  </button>

  <button class="nav-item" data-tab-target="movimenti">
    <ion-icon class="nav-icon" name="document-text-outline"></ion-icon>
  </button>

  <button class="nav-item" data-tab-target="ricorrenti">
    <ion-icon class="nav-icon" name="repeat-outline"></ion-icon>
  </button>

  <button class="nav-item" data-tab-target="settings">
    <ion-icon class="nav-icon" name="settings-outline"></ion-icon>
  </button>
</nav>



  
  <!-- Script Chart -->
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

  <!-- Script principale -->
  <script type="module" src="./app.js"></script>

</body>
</html>
